# Claude Code UI macOSã‚¢ãƒ—ãƒªåŒ– å®Œå…¨å®Ÿè£…ã‚¬ã‚¤ãƒ‰
# SuperClaude UltraThinkçµ±åˆç‰ˆ v1.0

metadata:
  author: "SuperClaude with All Personas"
  created: "2025-07-09 03:15:26 JST"
  last_updated: "2025-07-09 03:23:52 JST"
  purpose: "æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã®ä¸€æ°—é€šè²«å®Ÿè£…"
  context_optimization: true
  timezone: "JST"

prerequisites:
  verified:
    - node_version: "v24.3.0"
    - claude_code_cli: "1.0.44"
    - pm2_installed: true
    - repository_cloned: true
    - dependencies_installed: true
  paths:
    project_root: "/Users/miya/projects/claudecodeui"
    scripts_dir: "/Users/miya/projects/claudecodeui/scripts"
    logs_dir: "/Users/miya/projects/claudecodeui/logs"

implementation_steps:
  phase1_applescript_app:
    - name: "ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ"
      commands:
        - |
          cat > /tmp/claudeui_app.applescript << 'EOF'
          -- Claude Code UI Launcher
          -- Created: $(date "+%Y-%m-%d %H:%M:%S %Z")
          on run
              try
                  -- ç¾åœ¨æ™‚åˆ»ã‚’ãƒ­ã‚°
                  set currentTime to do shell script "date '+%Y-%m-%d %H:%M:%S %Z'"
                  
                  -- PM2ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
                  set pmStatus to do shell script "pm2 list | grep claude-ui || echo 'not found'"
                  
                  if pmStatus contains "online" then
                      -- ã™ã§ã«èµ·å‹•ä¸­
                      display notification "Claude Code UIã¯ã™ã§ã«èµ·å‹•ã—ã¦ã„ã¾ã™" with title "Claude Code UI" sound name "Pop"
                      delay 1
                      tell application "Safari" to open location "http://localhost:3009"
                  else
                      -- èµ·å‹•å‡¦ç†
                      display notification "Claude Code UIã‚’èµ·å‹•ã—ã¦ã„ã¾ã™..." with title "Claude Code UI"
                      do shell script "cd /Users/miya/projects/claudecodeui && pm2 start ecosystem.config.js"
                      delay 3
                      
                      -- èµ·å‹•ç¢ºèª
                      set checkStatus to do shell script "pm2 list | grep 'claude-ui.*online' || echo 'failed'"
                      if checkStatus contains "online" then
                          display notification "èµ·å‹•å®Œäº†ï¼ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ãã¾ã™" with title "Claude Code UI" sound name "Glass"
                          -- èµ·å‹•æ™‚åˆ»ã‚’ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜éŒ²
                          do shell script "echo '" & currentTime & " - Claude Code UI started' >> /Users/miya/projects/claudecodeui/logs/startup.log"
                          tell application "Safari" to open location "http://localhost:3009"
                      else
                          display alert "èµ·å‹•å¤±æ•—" message "è©³ç´°ã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ pm2 logs claude-ui ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
                      end if
                  end if
              on error errMsg
                  display alert "ã‚¨ãƒ©ãƒ¼" message errMsg
              end try
          end run
          EOF
        - "osacompile -o /Applications/ClaudeUI.app /tmp/claudeui_app.applescript"
        - "rm /tmp/claudeui_app.applescript"

  phase2_app_icon:
    - name: "ã‚¢ã‚¤ã‚³ãƒ³ä½œæˆã¨è¨­å®š"
      commands:
        - |
          # ã‚¢ã‚¤ã‚³ãƒ³ç”¨ã®SVGã‚’ä½œæˆ
          cat > ~/projects/claudecodeui/icon.svg << 'EOF'
          <svg width="512" height="512" xmlns="http://www.w3.org/2000/svg">
            <rect width="512" height="512" rx="100" fill="#6366F1"/>
            <text x="256" y="320" font-family="SF Pro Display, Arial" font-size="200" 
                  font-weight="bold" text-anchor="middle" fill="white">CI</text>
          </svg>
          EOF
        - "# macOSã®iconutilä½¿ç”¨ï¼ˆæ‰‹å‹•ã§ã‚¢ã‚¤ã‚³ãƒ³è¨­å®šãŒå¿…è¦ï¼‰"

  phase3_menu_bar:
    - name: "SwiftBarãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä½œæˆ"
      commands:
        - "brew install swiftbar || true"
        - "mkdir -p ~/Library/Application\\ Support/SwiftBar/Plugins"
        - |
          cat > ~/Library/Application\ Support/SwiftBar/Plugins/claudeui.1m.sh << 'EOF'
          #!/bin/bash
          # Claude Code UI Status for SwiftBar
          # Updated: $(date "+%Y-%m-%d %H:%M:%S %Z")
          
          if pm2 list 2>/dev/null | grep -q "claude-ui.*online"; then
              # æœ€çµ‚èµ·å‹•æ™‚åˆ»ã‚’å–å¾—
              LAST_START=$(tail -1 /Users/miya/projects/claudecodeui/logs/startup.log 2>/dev/null | cut -d' ' -f1,2 || echo "ä¸æ˜")
              
              echo "ğŸŸ¢ CI"
              echo "---"
              echo "ğŸ“Š çŠ¶æ…‹: èµ·å‹•ä¸­ | color=green"
              echo "ğŸ• èµ·å‹•æ™‚åˆ»: $LAST_START"
              echo "ğŸŒ ãƒ­ãƒ¼ã‚«ãƒ«: http://localhost:3009 | href=http://localhost:3009"
              IP=$(ifconfig | grep "inet " | grep -v 127.0.0.1 | awk '{print $2}' | head -1)
              if [ ! -z "$IP" ]; then
                  echo "ğŸ“± iPhone: http://$IP:3009 | href=http://$IP:3009"
              fi
              echo "---"
              echo "ğŸ”„ å†èµ·å‹• | bash='/Users/miya/projects/claudecodeui/scripts/restart-claude-ui.sh' terminal=false"
              echo "â¹ï¸ åœæ­¢ | bash='/Users/miya/projects/claudecodeui/scripts/stop-claude-ui.sh' terminal=false"
              echo "ğŸ“œ ãƒ­ã‚°è¡¨ç¤º | bash='pm2' param1='logs' param2='claude-ui' terminal=true"
          else
              echo "âšª CI"
              echo "---"
              echo "ğŸ“Š çŠ¶æ…‹: åœæ­¢ä¸­ | color=gray"
              echo "---"
              echo "â–¶ï¸ èµ·å‹• | bash='/Users/miya/projects/claudecodeui/scripts/start-claude-ui.sh' terminal=false"
          fi
          
          echo "---"
          echo "âš™ï¸ è¨­å®šãƒ•ã‚©ãƒ«ãƒ€ | bash='open' param1='/Users/miya/projects/claudecodeui'"
          echo "ğŸ”„ æ›´æ–° | refresh=true"
          echo "ğŸ• ç¾åœ¨æ™‚åˆ»: $(date '+%H:%M:%S') | color=gray"
          EOF
        - "chmod +x ~/Library/Application\\ Support/SwiftBar/Plugins/claudeui.1m.sh"

  phase4_helper_scripts:
    - name: "å†èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ"
      commands:
        - |
          cat > ~/projects/claudecodeui/scripts/restart-claude-ui.sh << 'EOF'
          #!/bin/bash
          # å†èµ·å‹•æ™‚åˆ»ã‚’è¨˜éŒ²
          echo "$(date '+%Y-%m-%d %H:%M:%S %Z') - Claude Code UI restarted" >> /Users/miya/projects/claudecodeui/logs/startup.log
          pm2 restart claude-ui
          EOF
        - "chmod +x ~/projects/claudecodeui/scripts/restart-claude-ui.sh"

  phase5_dock_automation:
    - name: "Dockã¸ã®è¿½åŠ ï¼ˆæ‰‹å‹•æ‰‹é †ï¼‰"
      manual_steps:
        - "Finderã§/Applicationsãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã"
        - "ClaudeUI.appã‚’Dockã«ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—"
        - "SwiftBarã‚’èµ·å‹•ã—ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’ç¢ºèª"

quick_commands:
  terminal_aliases:
    start: "cui"
    stop: "claude-ui-stop"
    status: "claude-ui-status"
    logs: "claude-ui-logs"
  
  app_locations:
    main_app: "/Applications/ClaudeUI.app"
    menu_bar: "SwiftBarã‹ã‚‰è‡ªå‹•èª­ã¿è¾¼ã¿"

validation_checklist:
  - "âœ“ ClaudeUI.appãŒApplicationsãƒ•ã‚©ãƒ«ãƒ€ã«å­˜åœ¨"
  - "âœ“ Dockã‹ã‚‰ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§èµ·å‹•å¯èƒ½"
  - "âœ“ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º"
  - "âœ“ èµ·å‹•æ™‚åˆ»ãŒæ­£ç¢ºã«è¨˜éŒ²ã•ã‚Œã‚‹"
  - "âœ“ iPhoneã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª"
  - "âœ“ PM2ã§ã®è‡ªå‹•å†èµ·å‹•æ©Ÿèƒ½"

troubleshooting:
  app_not_opening:
    - "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã§è¨±å¯: ã‚·ã‚¹ãƒ†ãƒ è¨­å®š > ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£"
  menu_bar_missing:
    - "SwiftBarã‚’èµ·å‹•: open -a SwiftBar"
  port_conflict:
    - "ãƒãƒ¼ãƒˆå¤‰æ›´: .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†"
  time_incorrect:
    - "ã‚·ã‚¹ãƒ†ãƒ æ™‚åˆ»ç¢ºèª: date ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèª"
    - "ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³è¨­å®š: ã‚·ã‚¹ãƒ†ãƒ è¨­å®š > æ—¥ä»˜ã¨æ™‚åˆ»"

# å®Ÿè£…ã‚³ãƒãƒ³ãƒ‰ï¼ˆã‚³ãƒ”ãƒšç”¨ï¼‰
implementation_command: |
  # æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œ:
  # yaml_content=$(cat /Users/miya/projects/claudecodeui/IMPLEMENTATION_GUIDE.yaml)
  # ä¸Šè¨˜ã®phase1ã‹ã‚‰é †ç•ªã«å®Ÿè¡Œ